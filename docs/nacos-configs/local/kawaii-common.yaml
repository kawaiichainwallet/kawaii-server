# ===========================================
# KawaiiChain Wallet 本地开发环境公共配置
# 命名空间: kawaii-local
# 文件名: kawaii-common.yml
# ===========================================

spring:
  # 数据库配置 - 本地PostgreSQL
  datasource:
    driver-class-name: org.postgresql.Driver
    username: rw
    password: Admin!123
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      idle-timeout: 300000
      connection-timeout: 20000
      validation-timeout: 3000
      leak-detection-threshold: 60000

  # Redis配置 - 本地Redis
  data:
    redis:
      host: localhost
      port: 6379
      password: 123456
      database: 0
      timeout: 5000ms
      lettuce:
        pool:
          max-active: 200
          max-wait: -1ms
          max-idle: 10
          min-idle: 0

  # Jackson统一配置 - 所有微服务共享
  jackson:
    default-property-inclusion: non_null
    date-format: yyyy-MM-dd'T'HH:mm:ss.SSSZ
    time-zone: UTC

# Feign配置 - 本地开发
feign:
  client:
    config:
      default:
        connectTimeout: 5000
        readTimeout: 10000
        loggerLevel: full  # 本地开发使用详细日志
  hystrix:
    enabled: false
  okhttp:
    enabled: true


# 管理端点配置 - 本地开发暴露所有端点
management:
  endpoints:
    web:
      exposure:
        include: "*"
  endpoint:
    health:
      show-details: always

# MyBatis-Plus通用配置 - 所有微服务共享
mybatis-plus:
  configuration:
    # 下划线转驼峰
    map-underscore-to-camel-case: true
    # 本地开发启用SQL日志（生产环境应关闭）
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      # 逻辑删除配置
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# ===========================================
# 应用公共配置
# ===========================================
app:
  # 时区配置
  timezone:
    default: UTC                          # 应用默认时区
    jvm-timezone: UTC                     # JVM时区设置

  # 安全配置
  security:
    # JWT统一配置 - 所有微服务共享
    jwt:
      # JWT生成和验证使用ES256算法（椭圆曲线数字签名算法）
      algorithm: ES256                   # 使用ECDSA with P-256 and SHA-256
      access-token-expiration: 3600      # 1小时 (本地开发)
      refresh-token-expiration: 604800   # 7天
      issuer: kawaii-wallet

      # EC公钥 (ES256算法) - P-256曲线
      # 用于验证JWT Token签名
      public-key: |
        -----BEGIN PUBLIC KEY-----
        MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQQbKGSWAq4Wa6jW35fh++sjgbFPh
        nQUxaD8pAuViamrAxBuJcdFyM9I40W2Y0Rp69AYjolLpXzgwz+oigKs+nA==
        -----END PUBLIC KEY-----
